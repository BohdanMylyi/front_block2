<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Form</title>
    <style>
        html {
            background-color: #1f2833;
            background-position: center;
            background-size: cover;
            color: #fff;
        }

        body {
            display: flex;
            justify-content: center;
        }

        form {
            display: flex;
            justify-content: center;
            flex-direction: column;
            text-align: center;
        }

        label {
            display: block;
            margin-bottom: 10px;
        }

        input[type="number"] {
            width: 50px;
        }

        .all-label {
            margin: 5px;
            padding: 5px;
            border-radius: 5px;
            border: 2px solid #45a29e;
        }

        .lang_radio,
        .country_checkboxes {
            display: flex;
            flex-direction: row;
            justify-content: center;
        }

        .all-inputs,
        select {
            width: 200px;
            margin: 5px auto;
            border-radius: 3px;
            height: 20px;
        }

        button {
            height: 40px;
            width: 160px;
            margin: 3px;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <form id="form">
        <label for="movie" class="all-label">Choose your favorite movie genre:</label>
        <select id="movie" name="movieGenre">
            <option value="Action">Action</option>
            <option value="Fantasy">Fantasy</option>
            <option value="Horror">Horror</option>
            <option value="Thriller">Thriller</option>
            <option value="Mystery">Mystery</option>
        </select>

        <label class="all-label" for="language">Which language do you prefer for watching movies?</label>
        <div class="lang_radio">
            <input type="radio" name="language" value="English" id="language"> English
            <input type="radio" name="language" value="Ukrainian" id="language"> Ukrainian
            <input type="radio" name="language" value="Another" id="language"> Another
        </div>

        <label class="all-label" for="country">What country do the best movies?</label>
        <div class="country_checkboxes">
            <input type="checkbox" name="country" value="USA" id="country"> USA
            <input type="checkbox" name="country" value="France" id="country"> France
            <input type="checkbox" name="country" value="Spain" id="country"> Spain
        </div>

        <label for="cinemaTime" class="all-label">Write the date when you were in the cinema last time?</label>
        <input type="datetime-local" id="cinemaTime" name="cinemaTime" class="all-inputs">

        <label for="averageScore" class="all-label">Rate the movie what you watched recently:</label>
        <input type="number" id="averageScore" name="averageScore" min="1" max="10" class="all-inputs">

        <label for="favFilm" class="all-label">Write about your favourite film:</label>
        <textarea name="favFilm" id="favFilm" cols="30" rows="10"></textarea>

        <label for="url" class="all-label">Input URL where you usually watch movies online: </label>
        <input type="url" name="url" id="url" placeholder="https://example.com" pattern="https://.*" size="30"
            class="all-inputs">

        <label for="food_choice" class="all-label">Food that you like to eat when you watch a movie:</label>
        <input list="food" id="food_choice" name="food" class="all-inputs">
        <datalist id="food">
            <option value="Chocolate">Chocolate</option>
            <option value="Chips">Chips</option>
            <option value="Popcorn">Popcorn</option>
            <option value="Sweat Potato">Sweat Potato</option>
            <option value="Another">Another</option>
        </datalist>

        <label for="email" class="all-label">Enter your email:</label>
        <input type="email" id="email" name="email" class="all-inputs">


        <label for="phone" class="all-label">Enter your phone number:</label>
        <input type="tel" id="phone" name="phone" class="all-inputs">
        <div class="all-buttons">
            <button type="submit">Submit</button>
            <button id="actionFilterButton">Filter by Action Genre</button>
            <br>
            <button id="averageScoreFilterButton">Filter by Average Score < 5</button>
            <button id="phoneNumberFilterButton">Filter by Phone Number (Starting with 099)</button>
        </div>
        <div id="displayArea"></div>

    </form>

    <script>
        const form = document.getElementById('form');
        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const formData = {};

            const movieSelect = document.getElementById('movie');
            formData[movieSelect.name] = movieSelect.value;

            const formElements = form.elements;

            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];

                if (element.name && element.value) {
                    formData[element.name] = element.value;
                }
            }

            const selectedLanguage = document.querySelector('input[name="language"]:checked').value;
            formData['language'] = selectedLanguage;
            const submissionId = Math.random().toString(36).substring(2, 15);

            localStorage.setItem(submissionId, JSON.stringify(formData));

            alert('Form data saved to localStorage with ID: ' + submissionId);
        });

        const actionFilterButton = document.getElementById('actionFilterButton');
        actionFilterButton.addEventListener('click', function () {
            filterByGenre('Action');
        });

        // Фільтр для середньої оцінки менше 5
        const averageScoreFilterButton = document.getElementById('averageScoreFilterButton');
        averageScoreFilterButton.addEventListener('click', function () {
            filterByAverageScore(5);
        });

        // Фільтр для номера телефону, що починається з "099"
        const phoneNumberFilterButton = document.getElementById('phoneNumberFilterButton');
        phoneNumberFilterButton.addEventListener('click', function () {
            filterByPhoneNumber('099');
        });

        function filterByGenre(genre) {
            const formDataKeys = Object.keys(localStorage);
            for (let i = 0; i < formDataKeys.length; i++) {
                const submissionId = formDataKeys[i];
                const formData = localStorage.getItem(submissionId);
                if (formData) {
                    const parsedData = JSON.parse(formData);
                    if (parsedData['movieGenre'] === genre) {
                        displayData(parsedData);
                    }
                }
            }
        }

        function filterByAverageScore(score) {
            const formDataKeys = Object.keys(localStorage);
            for (let i = 0; i < formDataKeys.length; i++) {
                const submissionId = formDataKeys[i];
                const formData = localStorage.getItem(submissionId);
                if (formData) {
                    const parsedData = JSON.parse(formData);
                    if (parseInt(parsedData['averageScore']) < score) {
                        displayData(parsedData);
                    }
                }
            }
        }

        function filterByPhoneNumber(prefix) {
            const formDataKeys = Object.keys(localStorage);
            for (let i = 0; i < formDataKeys.length; i++) {
                const submissionId = formDataKeys[i];
                const formData = localStorage.getItem(submissionId);
                if (formData) {
                    const parsedData = JSON.parse(formData);
                    const phoneNumber = parsedData['phone'];
                    if (phoneNumber && phoneNumber.startsWith(prefix)) {
                        displayData(parsedData);
                    }
                }
            }
        }

        function displayData(data) {
            const displayArea = document.getElementById('displayArea');
            const dataDiv = document.createElement('div');
            dataDiv.innerHTML = `
        <p>Movie Genre: ${data['movieGenre']}</p>
        <p>Language: ${data['language']}</p>
        <p>Average Score: ${data['averageScore']}</p>
        <!-- Додайте інші поля, які ви хочете відобразити -->
    `;
            displayArea.appendChild(dataDiv);
        }
    </script>
</body>

</html>