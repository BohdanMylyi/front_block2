<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Form</title>
    <style>
        body {
            display: flex;
            justify-content: center;
        }

        form {
            margin: auto;
        }

        label {
            display: block;
            margin-bottom: 10px;
        }

        input[type="number"] {
            width: 50px;
        }
    </style>
</head>

<body>
    <form id="form">
        <label for="movie">Choose your favorite movie genre:</label>
        <select id="movie" name="movieGenre">
            <option value="Action">Action</option>
            <option value="Fantasy">Fantasy</option>
            <option value="Horror">Horror</option>
            <option value="Thriller">Thriller</option>
            <option value="Mystery">Mystery</option>
        </select>

        <label>Which language do you prefer for watching movies?</label>
        <input type="radio" name="language" value="English"> English
        <input type="radio" name="language" value="Ukrainian"> Ukrainian
        <input type="radio" name="language" value="Another"> Another

        <label>What country do the best movies?</label>
        <input type="checkbox" name="country" value="USA"> USA
        <input type="checkbox" name="country" value="France"> France
        <input type="checkbox" name="country" value="Spain"> Spain

        <label for="cinemaTime">Write the date when you were in the cinema last time?</label>
        <input type="datetime-local" id="cinemaTime" name="cinemaTime">

        <label for="averageScore">Rate the movie what you watched recently:</label>
        <input type="number" id="averageScore" name="averageScore" min="1" max="10">

        <label for="favFilm">Write about your favourite film:</label>
        <textarea name="favFilm" id="favFilm" cols="30" rows="10"></textarea>

        <label for="url">Input URL where you usually watch movies online: </label>
        <input type="url" name="url" id="url" placeholder="https://example.com" pattern="https://.*" size="30">

        <label for="food_choice">Food that you like to eat when you watch a movie:</label>
        <input list="food" id="food_choice" name="food">
        <datalist id="food">
            <option value="Chocolate">Chocolate</option>
            <option value="Chips">Chips</option>
            <option value="Popcorn">Popcorn</option>
            <option value="Sweat Potato">Sweat Potato</option>
            <option value="Another">Another</option>
        </datalist>

        <label for="email">Enter your email:</label>
        <input type="email" id="email" name="email">


        <label for="phone">Enter your phone number:</label>
        <input type="tel" id="phone" name="phone">
        <button type="submit">Submit</button>
        <button id="actionFilterButton">Filter by Action Genre</button>
        <button id="averageScoreFilterButton">Filter by Average Score < 5</button>
                <button id="phoneNumberFilterButton">Filter by Phone Number (Starting with 099)</button>
                <div id="displayArea"></div>

    </form>

    <script>
        const form = document.getElementById('form');
        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const formData = {};

            const movieSelect = document.getElementById('movie');
            formData[movieSelect.name] = movieSelect.value;

            const formElements = form.elements;

            for (let i = 0; i < formElements.length; i++) {
                const element = formElements[i];

                if (element.name && element.value) {
                    formData[element.name] = element.value;
                }
            }

            const selectedLanguage = document.querySelector('input[name="language"]:checked').value;
            formData['language'] = selectedLanguage;
            const submissionId = Math.random().toString(36).substring(2, 15);

            localStorage.setItem(submissionId, JSON.stringify(formData));

            alert('Form data saved to localStorage with ID: ' + submissionId);
        });

        const actionFilterButton = document.getElementById('actionFilterButton');
        actionFilterButton.addEventListener('click', function () {
            filterByGenre('Action');
        });

        // Фільтр для середньої оцінки менше 5
        const averageScoreFilterButton = document.getElementById('averageScoreFilterButton');
        averageScoreFilterButton.addEventListener('click', function () {
            filterByAverageScore(5);
        });

        // Фільтр для номера телефону, що починається з "099"
        const phoneNumberFilterButton = document.getElementById('phoneNumberFilterButton');
        phoneNumberFilterButton.addEventListener('click', function () {
            filterByPhoneNumber('099');
        });

        function filterByGenre(genre) {
            const formDataKeys = Object.keys(localStorage);
            for (let i = 0; i < formDataKeys.length; i++) {
                const submissionId = formDataKeys[i];
                const formData = localStorage.getItem(submissionId);
                if (formData) {
                    const parsedData = JSON.parse(formData);
                    if (parsedData['movieGenre'] === genre) {
                        displayData(parsedData);
                    }
                }
            }
        }

        function filterByAverageScore(score) {
            const formDataKeys = Object.keys(localStorage);
            for (let i = 0; i < formDataKeys.length; i++) {
                const submissionId = formDataKeys[i];
                const formData = localStorage.getItem(submissionId);
                if (formData) {
                    const parsedData = JSON.parse(formData);
                    if (parseInt(parsedData['averageScore']) < score) {
                        displayData(parsedData);
                    }
                }
            }
        }

        function filterByPhoneNumber(prefix) {
            const formDataKeys = Object.keys(localStorage);
            for (let i = 0; i < formDataKeys.length; i++) {
                const submissionId = formDataKeys[i];
                const formData = localStorage.getItem(submissionId);
                if (formData) {
                    const parsedData = JSON.parse(formData);
                    const phoneNumber = parsedData['phone'];
                    if (phoneNumber && phoneNumber.startsWith(prefix)) {
                        displayData(parsedData);
                    }
                }
            }
        }

        function displayData(data) {
            const displayArea = document.getElementById('displayArea');
            const dataDiv = document.createElement('div');
            dataDiv.innerHTML = `
        <p>Movie Genre: ${data['movieGenre']}</p>
        <p>Language: ${data['language']}</p>
        <p>Average Score: ${data['averageScore']}</p>
        <!-- Додайте інші поля, які ви хочете відобразити -->
    `;
            displayArea.appendChild(dataDiv);
        }
    </script>
</body>

</html>